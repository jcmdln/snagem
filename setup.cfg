# SPDX-License-Identifier: AGPL-3.0-or-later

[flake8]
# TODO: ignore fewer things
ignore =
    D100 # Missing docstring in public module
    D101 # Missing docstring in public class
    D102 # Missing docstring in public method
    D103 # Missing docstring in public function
    D104 # Missing docstring in public package
    D105 # Missing docstring in magic method
    D106 # Missing docstring in public nested class
    D107 # Missing docstring in __init__
    D202 # No blank lines allowed after function docstring
    D401 # First line should be in imperative mood
    W503 # Line break before binary operator
max-line-length = 99

[tox:tox]
envlist =
    bandit
    coverage
    flake8
    mypy
    pytest
ignore_basepython_conflict = true
isolated_build = true
minversion = 3.20.0
skip_missing_interpreters = true

[testenv]
allowlist_externals = poetry
skip_install = true

[testenv:bandit]
commands =
    poetry install --only bandit
    poetry run bandit --version
    poetry run bandit -qrc "{toxinidir}/pyproject.toml" {toxinidir}/snag/ {toxinidir}/snagd/

[testenv:coverage]
commands =
    poetry install --only coverage
    poetry run coverage --version

[testenv:flake8]
commands =
    poetry install --only flake8
    poetry run flake8 --version
    poetry run flake8 {toxinidir}/snag/ {toxinidir}/snagd/

[testenv:mypy]
commands =
    poetry install --only mypy
    poetry run mypy --version
    poetry run mypy {toxinidir}/snag/ {toxinidir}/snagd/

[testenv:pytest]
commands =
    poetry install --only pytest
    poetry run pytest --version
