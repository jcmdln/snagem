# SPDX-License-Identifier: AGPL-3.0-or-later

[flake8]
ignore =
    D100, # Missing docstring in public module
    D101, # Missing docstring in public class
    D102, # Missing docstring in public method
    D103, # Missing docstring in public function
    D104, # Missing docstring in public package
    D105, # Missing docstring in magic method
    D107, # pydocstyle: Missing docstring in __init__
    D202, # pydocstyle: No blank lines allowed after function docstring
    D401, # pydocstyle: First line should be in imperative mood
    W503, # Line break before binary operator
max-line-length = 99

[tox:tox]
envlist =
    coverage
    bandit
    flake8
    mypy
    pytest
ignore_basepython_conflict = true
isolated_build = true
minversion = 3.20.0
skip_missing_interpreters = true

[testenv]
allowlist_externals = poetry
basepython = python3
commands =
    poetry --version
    poetry install --no-root
setenv =
    PYTHONDONTWRITEBYTECODE=true
    PYTHONPYCACHEPREFIX=/tmp
    PYTHONUNBUFFERED=true
skip_install = true

[testenv:coverage]
allowlist_externals = coverage
commands =
    coverage --version

[testenv:bandit]
allowlist_externals = bandit
commands =
    bandit --version
    bandit -qc {toxinidir}/.bandit.yml -r snagctl/
    bandit -qc {toxinidir}/.bandit.yml -r snagd/

[testenv:flake8]
allowlist_externals = flake8
commands =
    flake8 --version
    flake8 snagctl/
    flake8 snagd/

[testenv:mypy]
allowlist_externals = mypy
commands =
    mypy --version
    mypy snagctl/
    mypy snagd/

[testenv:pytest]
allowlist_externals = pytest
commands =
    pytest --version
